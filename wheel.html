<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹¸é‹å¤§è¼ªç›¤ - æ“´å……ç‰ˆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            justify-content: center;
            align-items: flex-start;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        /* å·¦å´æ§åˆ¶å€ */
        .controls {
            width: 300px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        textarea {
            width: 100%;
            height: 180px; /* å¢åŠ é«˜åº¦ä»¥ä¾¿è¼¸å…¥æ›´å¤šé¸é … */
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 10px;
            resize: vertical;
            font-size: 16px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
        }

        button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: transform 0.1s, opacity 0.2s;
            flex: 1;
        }

        button:active {
            transform: scale(0.98);
        }

        #spinBtn {
            background-color: #ff4757;
            color: white;
            font-size: 18px;
        }

        #updateBtn {
            background-color: #2ed573;
            color: white;
        }

        /* å³å´è¼ªç›¤å€ */
        .wheel-container {
            position: relative;
            width: 400px;
            height: 400px;
        }

        canvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99); /* è½‰å‹•å‹•ç•« */
        }

        /* æŒ‡é‡ */
        .pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 50px;
            background-color: #333;
            clip-path: polygon(100% 0, 50% 100%, 0 0);
            z-index: 10;
        }

        #result {
            margin-top: 20px;
            font-size: 24px;
            font-weight: bold;
            color: #2f3542;
            height: 30px;
            text-align: center;
        }

        /* æ‰‹æ©Ÿç‰ˆéŸ¿æ‡‰å¼èª¿æ•´ */
        @media (max-width: 768px) {
            .container {
                flex-direction: column-reverse;
                align-items: center;
            }
            .wheel-container {
                width: 300px;
                height: 300px;
            }
            .controls {
                width: 100%;
            }
        }
    </style>
</head>
<body>

    <h1>ğŸ¡ å¹¸é‹å¤§è¼ªç›¤</h1>

    <div class="container">
        <div class="controls">
            <label for="options">è¼¸å…¥é¸é … (ä¸€è¡Œä¸€å€‹ï¼Œå¯è¼¸å…¥è¶…é 20 å€‹!):</label>
            <textarea id="options">é¸é … 1: æ»·è‚‰é£¯
é¸é … 2: ç‰›è‚‰éºµ
é¸é … 3: éº¥ç•¶å‹
é¸é … 4: å£½å¸
é¸é … 5: æ°´é¤ƒ
é¸é … 6: æ¸›è‚¥æ²™æ‹‰
é¸é … 7: ç«é‹
é¸é … 8: å’–å“©é£¯
é¸é … 9: ç¾©å¤§åˆ©éºµ
é¸é … 10: æŠ«è–©
é¸é … 11: éµæ¿ç‡’
é¸é … 12: è¶Šå—æ²³ç²‰</textarea>
            
            <div class="btn-group">
                <button id="updateBtn" onclick="initWheel()">é‡ç¹ªè¼ªç›¤</button>
            </div>
            <button id="spinBtn" onclick="spinWheel()">é–‹å§‹æ—‹è½‰ï¼</button>
            
            <div id="result">æº–å‚™æŠ½ç±¤...</div>
        </div>

        <div class="wheel-container">
            <div class="pointer"></div>
            <canvas id="wheelCanvas" width="500" height="500"></canvas>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');
        const resultDiv = document.getElementById('result');
        const textarea = document.getElementById('options');

        let options = [];
        let currentRotation = 0;
        let isSpinning = false;
        
        // **é‡è¦æ›´æ–°**ï¼šæ“´å……é¡è‰²æ–¹æ¡ˆè‡³ 24 ç¨®ï¼Œç¢ºä¿å¤šé¸é …æ™‚é¡è‰²ä¸é‡è¤‡ï¼
        const colors = [
            '#FF6347', '#3CB371', '#4682B4', '#FFA07A', '#9370DB', '#FFD700', 
            '#20B2AA', '#F08080', '#B0C4DE', '#ADFF2F', '#FF1493', '#7FFFD4',
            '#8A2BE2', '#D2691E', '#FF4500', '#00BFFF', '#98FB98', '#FF69B4',
            '#FFC0CB', '#DAA520', '#1E90FF', '#7CFC00', '#B8860B', '#32CD32'
        ];

        // åˆå§‹åŒ–
        function initWheel() {
            // å¾è¼¸å…¥æ¡†è®€å–è³‡æ–™ï¼Œéæ¿¾ç©ºè¡Œ
            options = textarea.value.split('\n').filter(opt => opt.trim() !== '');
            
            if (options.length === 0) {
                alert("è«‹è‡³å°‘è¼¸å…¥ä¸€å€‹é¸é …ï¼");
                return;
            }

            drawWheel();
            resultDiv.innerText = "æº–å‚™å°±ç·’ï¼";
            resultDiv.style.color = "#333";
        }

        // ç¹ªè£½è¼ªç›¤
        function drawWheel() {
            const numOptions = options.length;
            const arcSize = (2 * Math.PI) / numOptions;
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = canvas.width / 2;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            for (let i = 0; i < numOptions; i++) {
                const angle = i * arcSize - Math.PI / 2; // -90åº¦é–‹å§‹ç•«ï¼Œè®“ç¬¬ä¸€å€‹åœ¨æ­£ä¸Šæ–¹

                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, angle, angle + arcSize);
                // ä½¿ç”¨ (i % colors.length) ç¢ºä¿å¾ªç’°ä½¿ç”¨é¡è‰²
                ctx.fillStyle = colors[i % colors.length]; 
                ctx.fill();
                ctx.stroke();

                // ç¹ªè£½æ–‡å­—
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(angle + arcSize / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "#fff";
                
                // **æ–‡å­—å¤§å°å‹•æ…‹èª¿æ•´**ï¼šé¸é …è¶Šå¤šï¼Œå­—é«”è¶Šå°ï¼Œé¿å…é‡ç–Š
                ctx.font = `bold ${Math.max(16, 28 - numOptions)}px Arial`; 
                
                ctx.fillText(options[i], radius - 20, 10);
                ctx.restore();
            }
        }

        // æ—‹è½‰é‚è¼¯
        function spinWheel() {
            if (isSpinning) return;
            if (options.length === 0) {
                initWheel(); 
                if(options.length === 0) return;
            }

            isSpinning = true;
            resultDiv.innerText = "æ—‹è½‰ä¸­...";
            
            // è¨ˆç®—æ—‹è½‰è§’åº¦ï¼šç›®å‰çš„è§’åº¦ + éš¨æ©Ÿåœˆæ•¸(5-10åœˆ) + éš¨æ©Ÿåç§»
            const randomSpins = Math.floor(Math.random() * 5) + 5; 
            const randomDegree = Math.floor(Math.random() * 360);
            const totalDegree = randomSpins * 360 + randomDegree;

            // ç´¯ç©æ—‹è½‰è§’åº¦
            currentRotation += totalDegree;

            // æ‡‰ç”¨ CSS æ—‹è½‰
            canvas.style.transform = `rotate(${currentRotation}deg)`;

            // ç›£è½å‹•ç•«çµæŸ
            setTimeout(() => {
                isSpinning = false;
                calculateWinner(currentRotation);
            }, 4000); 
        }

        // è¨ˆç®—è´å®¶
        function calculateWinner(rotation) {
            const numOptions = options.length;
            const arcSize = 360 / numOptions;
            
            // å¯¦éš›åœ¨æŒ‡é‡ä¸‹çš„è§’åº¦ (æŠµæ¶ˆæ‰é †æ™‚é‡æ—‹è½‰çš„è§’åº¦)
            const actualDeg = (360 - (rotation % 360)) % 360;
            
            const index = Math.floor(actualDeg / arcSize);
            const winner = options[index];

            resultDiv.innerText = `çµæœæ˜¯ï¼š${winner}ï¼`;
            resultDiv.style.color = "#d63031";
            
            // ç°¡å–®çš„æ…¶ç¥ç‰¹æ•ˆ
            canvas.style.transition = "none"; 
            setTimeout(() => {
                 canvas.style.transition = "transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99)";
            }, 50);
        }

        // é é¢è¼‰å…¥æ™‚å…ˆç•«ä¸€æ¬¡
        window.onload = initWheel;
    </script>
</body>
</html>